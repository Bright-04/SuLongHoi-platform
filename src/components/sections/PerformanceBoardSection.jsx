import React, { useState, useRef } from "react";
import { motion, useInView } from "framer-motion";
import "../../styles/sections/PerformanceBoardSection.css";

const PerformanceBoardSection = () => {
	const [selectedCategory, setSelectedCategory] = useState("all");
	const [sortBy, setSortBy] = useState("rank");
	const sectionRef = useRef(null);
	const isInView = useInView(sectionRef, { once: true, margin: "-100px" });

	// Performance categories
	const performanceCategories = [
		{ id: "all", name: "T·∫•t c·∫£", icon: "üèÜ" },
		{ id: "national", name: "Qu·ªëc gia", icon: "üáªüá≥" },
		{ id: "international", name: "Qu·ªëc t·∫ø", icon: "üåç" },
		{ id: "regional", name: "Khu v·ª±c", icon: "üèòÔ∏è" },
		{ id: "youth", name: "Thi·∫øu nhi", icon: "üë∂" },
	];

	// Performance data
	const performanceData = [
		{
			id: 1,
			rank: 1,
			teamName: "ƒê·ªôi L√¢n S∆∞ R·ªìng V√†ng",
			location: "H·ªì Ch√≠ Minh",
			category: "national",
			score: 98.5,
			achievements: ["Gi·∫£i nh·∫•t Festival L√¢n S∆∞ 2023", "ƒê·∫°i di·ªán Vi·ªát Nam t·∫°i World Lion Dance Championship 2022", "Gi·∫£i nh·∫•t H·ªôi di·ªÖn VƒÉn ngh·ªá Qu·∫ßn ch√∫ng 2021"],
			performances: 156,
			yearsActive: 28,
			members: 25,
			image: "/src/assets/images/illustrations/mockup(1).jpg",
			badge: "ü•á",
			trend: "up",
		},
		{
			id: 2,
			rank: 2,
			teamName: "ƒê·ªôi L√¢n S∆∞ Ph∆∞·ª£ng Ho√†ng",
			location: "H√† N·ªôi",
			category: "national",
			score: 96.8,
			achievements: ["Gi·∫£i nh√¨ Festival L√¢n S∆∞ 2023", "Gi·∫£i nh·∫•t H·ªôi di·ªÖn VƒÉn ngh·ªá Qu·∫ßn ch√∫ng 2021", "Gi·∫£i ba World Lion Dance Championship 2022"],
			performances: 142,
			yearsActive: 23,
			members: 18,
			image: "/src/assets/images/illustrations/mockup(10).JPG",
			badge: "ü•à",
			trend: "up",
		},
		{
			id: 3,
			rank: 3,
			teamName: "ƒê·ªôi L√¢n S∆∞ Thi√™n Long",
			location: "ƒê√† N·∫µng",
			category: "national",
			score: 95.2,
			achievements: ["Gi·∫£i ba Festival L√¢n S∆∞ 2023", "Gi·∫£i nh·∫•t Li√™n hoan VƒÉn h√≥a Mi·ªÅn Trung 2022", "Gi·∫£i nh√¨ H·ªôi di·ªÖn VƒÉn ngh·ªá Qu·∫ßn ch√∫ng 2021"],
			performances: 128,
			yearsActive: 15,
			members: 22,
			image: "/src/assets/images/illustrations/mockup(11).JPG",
			badge: "ü•â",
			trend: "stable",
		},
		{
			id: 4,
			rank: 4,
			teamName: "ƒê·ªôi L√¢n S∆∞ Hoa Sen",
			location: "C·∫ßn Th∆°",
			category: "regional",
			score: 93.7,
			achievements: ["Gi·∫£i nh·∫•t Li√™n hoan VƒÉn h√≥a ƒê·ªìng b·∫±ng s√¥ng C·ª≠u Long 2023", "Gi·∫£i nh√¨ Festival L√¢n S∆∞ 2023", "Gi·∫£i nh·∫•t H·ªôi di·ªÖn VƒÉn ngh·ªá Mi·ªÅn Nam 2022"],
			performances: 98,
			yearsActive: 12,
			members: 20,
			image: "/src/assets/images/illustrations/mockup(12).JPG",
			badge: "üèÖ",
			trend: "up",
		},
		{
			id: 5,
			rank: 5,
			teamName: "ƒê·ªôi L√¢n S∆∞ B·∫£o V·ªá",
			location: "H·∫£i Ph√≤ng",
			category: "regional",
			score: 92.1,
			achievements: ["Gi·∫£i nh·∫•t Li√™n hoan VƒÉn h√≥a Mi·ªÅn B·∫Øc 2023", "Gi·∫£i ba Festival L√¢n S∆∞ 2023", "Gi·∫£i nh√¨ H·ªôi di·ªÖn VƒÉn ngh·ªá Mi·ªÅn B·∫Øc 2022"],
			performances: 87,
			yearsActive: 18,
			members: 16,
			image: "/src/assets/images/illustrations/mockup(13).JPG",
			badge: "üèÖ",
			trend: "down",
		},
		{
			id: 6,
			rank: 6,
			teamName: "ƒê·ªôi L√¢n S∆∞ Tu·ªïi Th∆°",
			location: "H·ªì Ch√≠ Minh",
			category: "youth",
			score: 90.5,
			achievements: ["Gi·∫£i nh·∫•t Li√™n hoan L√¢n S∆∞ Thi·∫øu nhi 2023", "Gi·∫£i nh√¨ Festival L√¢n S∆∞ 2023 (H·∫°ng thi·∫øu nhi)", "Gi·∫£i nh·∫•t H·ªôi di·ªÖn VƒÉn ngh·ªá Thi·∫øu nhi 2022"],
			performances: 65,
			yearsActive: 8,
			members: 12,
			image: "/src/assets/images/illustrations/mockup(8).JPG",
			badge: "üë∂",
			trend: "up",
		},
		{
			id: 7,
			rank: 7,
			teamName: "ƒê·ªôi L√¢n S∆∞ H√πng V∆∞∆°ng",
			location: "Hu·∫ø",
			category: "regional",
			score: 89.3,
			achievements: ["Gi·∫£i nh√¨ Li√™n hoan VƒÉn h√≥a Mi·ªÅn Trung 2023", "Gi·∫£i ba Festival L√¢n S∆∞ 2023", "Gi·∫£i nh·∫•t H·ªôi di·ªÖn VƒÉn ngh·ªá Th·ª´a Thi√™n Hu·∫ø 2022"],
			performances: 76,
			yearsActive: 14,
			members: 19,
			image: "/src/assets/images/illustrations/mockup(9).jpg",
			badge: "üèÖ",
			trend: "stable",
		},
		{
			id: 8,
			rank: 8,
			teamName: "ƒê·ªôi L√¢n S∆∞ Vi·ªát Nam",
			location: "H√† N·ªôi",
			category: "international",
			score: 88.7,
			achievements: ["ƒê·∫°i di·ªán Vi·ªát Nam t·∫°i World Lion Dance Championship 2023", "Gi·∫£i nh√¨ Asian Lion Dance Championship 2022", "Gi·∫£i nh·∫•t Southeast Asian Lion Dance Festival 2021"],
			performances: 45,
			yearsActive: 20,
			members: 30,
			image: "/src/assets/images/illustrations/collage1.png",
			badge: "üåç",
			trend: "up",
		},
	];

	// Filter and sort data
	const filteredData = selectedCategory === "all" ? performanceData : performanceData.filter((team) => team.category === selectedCategory);

	const sortedData = [...filteredData].sort((a, b) => {
		switch (sortBy) {
			case "rank":
				return a.rank - b.rank;
			case "score":
				return b.score - a.score;
			case "performances":
				return b.performances - a.performances;
			case "yearsActive":
				return b.yearsActive - a.yearsActive;
			default:
				return a.rank - b.rank;
		}
	});

	const getTrendIcon = (trend) => {
		switch (trend) {
			case "up":
				return "üìà";
			case "down":
				return "üìâ";
			case "stable":
				return "‚û°Ô∏è";
			default:
				return "‚û°Ô∏è";
		}
	};

	return (
		<section ref={sectionRef} className="performance-board-section">
			<div className="container">
				{/* Section Header */}
				<motion.div className="section-header" initial={{ opacity: 0, y: 50 }} animate={isInView ? { opacity: 1, y: 0 } : {}} transition={{ duration: 0.8 }}>
					<h2 className="section-title">
						<span className="title-text">B·∫£ng X·∫øp H·∫°ng Th√†nh T√≠ch</span>
					</h2>
					<p className="section-subtitle">Top c√°c ƒë·ªôi l√¢n s∆∞ xu·∫•t s·∫Øc nh·∫•t Vi·ªát Nam</p>
					<div className="section-description">
						<p>Kh√°m ph√° nh·ªØng ƒë·ªôi l√¢n s∆∞ h√†ng ƒë·∫ßu v·ªõi th√†nh t√≠ch ·∫•n t∆∞·ª£ng, t·ª´ c√°c gi·∫£i th∆∞·ªüng qu·ªëc gia ƒë·∫øn th√†nh c√¥ng qu·ªëc t·∫ø.</p>
					</div>
				</motion.div>

				{/* Filters and Controls */}
				<motion.div className="board-controls" initial={{ opacity: 0, y: 30 }} animate={isInView ? { opacity: 1, y: 0 } : {}} transition={{ duration: 0.8, delay: 0.2 }}>
					{/* Category Filter */}
					<div className="category-filter">
						{performanceCategories.map((category) => (
							<button key={category.id} className={`category-btn ${selectedCategory === category.id ? "active" : ""}`} onClick={() => setSelectedCategory(category.id)}>
								<span className="category-icon">{category.icon}</span>
								<span className="category-name">{category.name}</span>
							</button>
						))}
					</div>

					{/* Sort Options */}
					<div className="sort-controls">
						<label htmlFor="sort-select">S·∫Øp x·∫øp theo:</label>
						<select id="sort-select" value={sortBy} onChange={(e) => setSortBy(e.target.value)} className="sort-select">
							<option value="rank">Th·ª© h·∫°ng</option>
							<option value="score">ƒêi·ªÉm s·ªë</option>
							<option value="performances">S·ªë bu·ªïi bi·ªÉu di·ªÖn</option>
							<option value="yearsActive">NƒÉm kinh nghi·ªám</option>
						</select>
					</div>
				</motion.div>

				{/* Performance Board */}
				<motion.div className="performance-board" initial={{ opacity: 0, y: 30 }} animate={isInView ? { opacity: 1, y: 0 } : {}} transition={{ duration: 0.8, delay: 0.4 }}>
					{/* Board Header */}
					<div className="board-header">
						<div className="header-rank">H·∫°ng</div>
						<div className="header-team">ƒê·ªôi l√¢n</div>
						<div className="header-score">ƒêi·ªÉm</div>
						<div className="header-stats">Th·ªëng k√™</div>
						<div className="header-achievements">Th√†nh t√≠ch</div>
						<div className="header-trend">Xu h∆∞·ªõng</div>
					</div>

					{/* Board Rows */}
					<div className="board-rows">
						{sortedData.map((team, index) => (
							<motion.div
								key={team.id}
								className="board-row"
								initial={{ opacity: 0, x: -50 }}
								animate={isInView ? { opacity: 1, x: 0 } : {}}
								transition={{ duration: 0.6, delay: 0.1 * index }}
							>
								{/* Rank */}
								<div className="row-rank">
									<span className="rank-number">{team.rank}</span>
									<span className="rank-badge">{team.badge}</span>
								</div>

								{/* Team Info */}
								<div className="row-team">
									<div className="team-avatar">
										<img
											src={team.image}
											alt={team.teamName}
											onError={(e) => {
												e.target.src = "/src/assets/images/illustrations/collage2.png";
											}}
										/>
									</div>
									<div className="team-info">
										<h4 className="team-name">{team.teamName}</h4>
										<p className="team-location">üìç {team.location}</p>
									</div>
								</div>

								{/* Score */}
								<div className="row-score">
									<div className="score-display">
										<span className="score-number">{team.score}</span>
										<div className="score-bar">
											<div className="score-fill" style={{ width: `${(team.score / 100) * 100}%` }} />
										</div>
									</div>
								</div>

								{/* Stats */}
								<div className="row-stats">
									<div className="stats-grid">
										<div className="stat-item">
											<span className="stat-label">Bi·ªÉu di·ªÖn</span>
											<span className="stat-value">{team.performances}</span>
										</div>
										<div className="stat-item">
											<span className="stat-label">Kinh nghi·ªám</span>
											<span className="stat-value">{team.yearsActive} nƒÉm</span>
										</div>
										<div className="stat-item">
											<span className="stat-label">Th√†nh vi√™n</span>
											<span className="stat-value">{team.members}</span>
										</div>
									</div>
								</div>

								{/* Achievements */}
								<div className="row-achievements">
									<div className="achievements-list">
										{team.achievements.slice(0, 2).map((achievement, idx) => (
											<div key={idx} className="achievement-item">
												<span className="achievement-icon">üèÜ</span>
												<span className="achievement-text">{achievement}</span>
											</div>
										))}
										{team.achievements.length > 2 && <div className="achievement-more">+{team.achievements.length - 2} th√†nh t√≠ch kh√°c</div>}
									</div>
								</div>

								{/* Trend */}
								<div className="row-trend">
									<span className="trend-icon">{getTrendIcon(team.trend)}</span>
								</div>
							</motion.div>
						))}
					</div>
				</motion.div>

				{/* Board Summary */}
				<motion.div className="board-summary" initial={{ opacity: 0 }} animate={isInView ? { opacity: 1 } : {}} transition={{ duration: 0.8, delay: 0.6 }}>
					<div className="summary-stats">
						<div className="summary-item">
							<span className="summary-number">{performanceData.length}</span>
							<span className="summary-label">ƒê·ªôi l√¢n xu·∫•t s·∫Øc</span>
						</div>
						<div className="summary-item">
							<span className="summary-number">{Math.round((performanceData.reduce((acc, team) => acc + team.score, 0) / performanceData.length) * 10) / 10}</span>
							<span className="summary-label">ƒêi·ªÉm trung b√¨nh</span>
						</div>
						<div className="summary-item">
							<span className="summary-number">{performanceData.reduce((acc, team) => acc + team.performances, 0)}</span>
							<span className="summary-label">T·ªïng bu·ªïi bi·ªÉu di·ªÖn</span>
						</div>
					</div>
				</motion.div>

				{/* Call to Action */}
				<motion.div className="board-cta" initial={{ opacity: 0 }} animate={isInView ? { opacity: 1 } : {}} transition={{ duration: 0.8, delay: 0.8 }}>
					<button className="cta-button primary">
						<span>üìä</span>
						Xem b√°o c√°o chi ti·∫øt
					</button>
					<button className="cta-button secondary">
						<span>üèÜ</span>
						ƒêƒÉng k√Ω tham gia
					</button>
				</motion.div>
			</div>
		</section>
	);
};

export default PerformanceBoardSection;
